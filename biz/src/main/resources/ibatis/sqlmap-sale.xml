<?xml version="1.0" encoding="GB2312"?>
<!DOCTYPE sqlMap
	PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN"
	"http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="sale">
	
	<typeAlias alias="sale" type="com.hsh24.admin.api.sale.bo.Sale" />
	
	<select id="getStats" parameterClass="sale" resultClass="sale">
	<![CDATA[
		SELECT SUM(p.pay_money) AS amount
		  FROM oms.ord_order_t t,
			   oms.ord_order_pay_t p,
			   dms_tb_org_shop q
		 WHERE t.order_dt >= date_format(#gmtStart#, '%Y-%m-%d %T')
		   AND t.order_dt <= date_format(#gmtEnd#, '%Y-%m-%d %T')
		   AND t.order_id = p.order_id
		   AND t.org_id = q.shop_id
		   AND t.order_status = '0005'
		   AND q.state = 'U'
		   AND q.org_id = #orgId#
	]]>
	</select>
	
	<select id="getSaleList1" parameterClass="sale" resultClass="sale">
	<![CDATA[
		SELECT SUM(p.pay_money) AS amount,
			   t.org_id AS shopId
		  FROM oms.ord_order_t t,
			   oms.ord_order_pay_t p,
			   dms_tb_org_shop q
		 WHERE t.order_dt >= date_format(#gmtStart#, '%Y-%m-%d %T')
		   AND t.order_dt <= date_format(#gmtEnd#, '%Y-%m-%d %T')
		   AND t.order_id = p.order_id
		   AND t.org_id = q.shop_id
		   AND t.order_status = '0005'
		   AND q.state = 'U'
		   AND q.org_id = #orgId#
		  GROUP BY t.org_id
	]]>
	</select>
	
	<select id="getSaleList2" parameterClass="sale" resultClass="sale">
	<![CDATA[
		SELECT p.pay_money AS amount,
			   t.order_cd AS tradeNo,
			   DATE_FORMAT(t.order_dt, '%Y-%m-%d %T') AS tradeDate
		  FROM oms.ord_order_t t,
			   oms.ord_order_pay_t p,
			   dms_tb_org_shop q
		 WHERE t.order_dt >= date_format(#gmtStart#, '%Y-%m-%d %T')
		   AND t.order_dt <= date_format(#gmtEnd#, '%Y-%m-%d %T')
		   AND t.order_id = p.order_id
		   AND t.org_id = q.shop_id
		   AND t.order_status = '0005'
		   AND q.state = 'U'
		   AND q.org_id = #orgId#
		   AND t.org_id = #shopId#
		  ORDER BY t.order_dt DESC
	]]>
	</select>
	
</sqlMap>